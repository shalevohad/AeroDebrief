name: Build & Test


on:
	push:
		branches: [ main, beta, release ]


jobs:
	build:
		runs-on: windows-latest


		steps:
			- uses: actions/checkout@v4
			- name: Setup .NET
			  uses: actions/setup-dotnet@v4
			  with:
				dotnet-version: '9.0.x'


			- name: Restore dependencies
			  run: dotnet restore


			- name: Build
			  run: dotnet build -c Release --no-restore


			- name: Test
			  run: dotnet test -c Release --no-build --verbosity normal


			- name: Publish artifact (Release only)
			  if: github.ref == 'refs/heads/release'
			  run: dotnet publish -c Release -o ./publish